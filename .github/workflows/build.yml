# name: GitHub Actions Demo
# run-name: ${{ github.actor }} is testing out GitHub Actions üöÄ
# on:
#         push:
#                 branches:
#                         - main
#         pull_request:
#                 types: [opened, synchronize, reopened]
# jobs:
#         # explore-github-actions:
#         #         name: "Explore"
#         #         runs-on: ubuntu-latest
#         #         steps:
#         #                 - run: echo "üéâ The job was automatically triggered by a ${{ github.event_name }} event."
#         #                 - run: echo "üêß This job is now running on a ${{ runner.os }} server hosted by GitHub!"
#         #                 - run: echo "üîé The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
#         #                 - name: Check out repository code
#         #                   uses: actions/checkout@v4
#         #                 - run: echo "üí° The ${{ github.repository }} repository has been cloned to the runner."
#         #                 - run: echo "üñ•Ô∏è The workflow is now ready to test your code on the runner."
# - name: List files in the repository
#   run: |
#           ls ${{ github.workspace }}
#         #                 - run: echo "üçè This job's status is ${{ job.status }}."
#         create-server-coverage:
#                 name: "create-server-coverage"
#                 runs-on: ubuntu-latest
#                 defaults:
#                         run:
#                                 working-directory: ./server
#                 steps:
#                         - name: Check out repository code
#                           uses: actions/checkout@v4
#                         - name: Use Node.js
#                           uses: actions/setup-node@v4
#                           with:
#                                   node-version: "20.x"
#                         - run: npm install
#                         - name: Generate coverage files
#                           run: npm run test:cov
#         sonarcloud:
#                 name: SonarCloud
#                 runs-on: ubuntu-latest
#                 needs: create-server-coverage
#                 # defaults:
#                 #         run:
#                 #                 working-directory: ./server
#                 steps:
#                         - uses: actions/checkout@v4
#                           with:
#                                   fetch-depth: 0 # Shallow clones should be disabled for a better relevancy of analysis
#                         - name: Use Node.js
#                           uses: actions/setup-node@v4
#                           with:
#                                   node-version: "20.x"
#                         - name: SonarCloud Scan
#                           uses: SonarSource/sonarcloud-github-action@master
#                           env:
#                                   GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # Needed to get PR information, if any
#                                   SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}

name: Build
on:
        push:
                branches:
                        - main
        pull_request:
                types: [opened, synchronize, reopened]
jobs:
        sonarcloud-front:
                defaults:
                        run:
                                working-directory: ./front
                name: SonarCloudFront
                runs-on: ubuntu-latest
                steps:
                        - uses: actions/checkout@v4
                          with:
                                  fetch-depth: 0 # Shallow clones should be disabled for a better relevancy of analysis
                        - name: List files in the repository
                          run: |
                                  ls ${{ github.workspace }}
                        - name: SonarCloud Scan
                          uses: SonarSource/sonarcloud-github-action@master
                          env:
                                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # Needed to get PR information, if any
                                  SONAR_TOKEN: ${{ secrets.SONAR_TOKEN_FRONT }}
        sonarcloud-server:
                defaults:
                        run:
                                working-directory: ./server
                name: SonarCloudServer
                runs-on: ubuntu-latest
                steps:
                        - uses: actions/checkout@v4
                          with:
                                  fetch-depth: 0 # Shallow clones should be disabled for a better relevancy of analysis
                        - name: List files in the repository
                          run: |
                                  ls ${{ github.workspace }}
                        - name: SonarCloud Scan
                          uses: SonarSource/sonarcloud-github-action@master
                          env:
                                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # Needed to get PR information, if any
                                  SONAR_TOKEN: ${{ secrets.SONAR_TOKEN_SERVER }}
